---
title: "Data extracted in systematic review"
author: "Andrew Baxter"
# date: "05/05/2021"
output: 
  html_document:
    css: "www/its_theme.css"
runtime: shiny
---

```{r setup, include=FALSE}
library(tidyverse)
library(DT)
knitr::opts_chunk$set(echo = FALSE)
options(DT.options = list(
            pageLength = 100,
          lengthChange = FALSE,
          columnDefs = list(
            list(visible = FALSE, targets = -1),
            list(className = 'dt-left', targets = 0),
            list(className = 'dt-center', targets = "_all")
          ),
          rowCallback = JS(
            "function(nRow, aData) {",
                  "$('td', nRow).attr('title',  aData[aData.length-1]);",
            "}"
          ),
          paging = FALSE
))
review_data <- readRDS("data/review_out.rds")
variables <- c("none", colnames(review_data))
variables <- variables[variables != "Reference" & variables != "Notes"]
```

```{css, echo=FALSE}

.main-container {
  max-width: none;
}

table {
  font-size: 16px;
}

thead tr:first-child {
  text-align: left;
}
```

```{r filter}

selectInput("filter",
            "Choose a variable to filter by",
            selected = "none",
            choices = variables,
            width = "400px")


renderDT({
  if (input$filter == "none") {
    review_data %>%
      datatable(
        selection = "none",
        rownames = FALSE
      )
  } else {
    review_data %>%
      select(Reference, input$filter, Notes) %>%
      filter(across(everything(), ~ !is.na(.x))) %>% 
      datatable(
        selection = "none",
        rownames = FALSE
      )
  }
})
```